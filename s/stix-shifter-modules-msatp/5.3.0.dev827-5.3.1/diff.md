# Comparing `tmp/stix_shifter_modules_msatp-5.3.0.dev827-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_msatp-5.3.1-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,29 +1,29 @@
-Zip file size: 54591 bytes, number of entries: 27
--rw-rw-r--  2.0 unx        0 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/__init__.py
--rw-rw-r--  2.0 unx      425 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/entry_point.py
--rw-rw-r--  2.0 unx   191814 b- defN 23-May-25 15:59 stix_shifter_modules/msatp/configuration/config.json
--rw-rw-r--  2.0 unx       78 b- defN 23-May-25 15:59 stix_shifter_modules/msatp/configuration/dialects.json
--rw-rw-r--  2.0 unx     5039 b- defN 23-May-25 15:59 stix_shifter_modules/msatp/configuration/lang_en.json
--rw-rw-r--  2.0 unx        1 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    22536 b- defN 23-May-25 15:59 stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    18741 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx     1038 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     8390 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/results_translator.py
--rw-rw-r--  2.0 unx     5510 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/transformers.py
--rw-rw-r--  2.0 unx    20749 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json
--rw-rw-r--  2.0 unx      583 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx    69903 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx    20764 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json
--rw-rw-r--  2.0 unx    68275 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     2952 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     3779 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_transmission/connector.py
--rw-rw-r--  2.0 unx    11998 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py
--rw-rw-r--  2.0 unx     1850 b- defN 23-May-25 15:57 stix_shifter_modules/msatp/stix_transmission/error_mapper.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8042 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3090 b- defN 23-May-25 15:59 stix_shifter_modules_msatp-5.3.0.dev827.dist-info/RECORD
-27 files, 479892 bytes uncompressed, 49295 bytes compressed:  89.7%
+Zip file size: 54404 bytes, number of entries: 27
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/__init__.py
+-rw-rw-r--  2.0 unx      425 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/entry_point.py
+-rw-rw-r--  2.0 unx   190665 b- defN 23-Jun-15 14:07 stix_shifter_modules/msatp/configuration/config.json
+-rw-rw-r--  2.0 unx       78 b- defN 23-Jun-15 14:07 stix_shifter_modules/msatp/configuration/dialects.json
+-rw-rw-r--  2.0 unx     4838 b- defN 23-Jun-15 14:07 stix_shifter_modules/msatp/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        1 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:07 stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    18741 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx     1038 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     8390 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/results_translator.py
+-rw-rw-r--  2.0 unx     5510 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/transformers.py
+-rw-rw-r--  2.0 unx    20749 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json
+-rw-rw-r--  2.0 unx      583 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx    69413 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx    20764 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json
+-rw-rw-r--  2.0 unx    67785 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     2873 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx     3779 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_transmission/connector.py
+-rw-rw-r--  2.0 unx    11998 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py
+-rw-rw-r--  2.0 unx     1887 b- defN 23-Jun-15 14:04 stix_shifter_modules/msatp/stix_transmission/error_mapper.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8035 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3048 b- defN 23-Jun-15 14:07 stix_shifter_modules_msatp-5.3.1.dist-info/RECORD
+27 files, 477581 bytes uncompressed, 49192 bytes compressed:  89.7%
```

## zipnote {}

```diff
@@ -57,26 +57,26 @@
 
 Filename: stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py
 Comment: 
 
 Filename: stix_shifter_modules/msatp/stix_transmission/error_mapper.py
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/LICENSE.md
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/METADATA
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/NOTICE
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/WHEEL
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/top_level.txt
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.3.0.dev827.dist-info/RECORD
+Filename: stix_shifter_modules_msatp-5.3.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/msatp/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9642856738154508%*

 * *Differences: {"'connection'": "{'options': {'mapping': {'default': {'to_stix_map': {'DeviceAlertEvents': "*

 * *                 "{'Timestamp': {2: {delete: ['cybox']}, 3: {delete: ['cybox']}}, 'event_count': "*

 * *                 "{delete: ['cybox']}}, 'DeviceNetworkEvents': {'Timestamp': {1: {delete: "*

 * *                 "['cybox']}, 2: {delete: ['cybox']}}, 'event_count': {delete: ['cybox']}}, "*

 * *                 "'DeviceProcessEvents': {'Timestamp': {1: {delete: ['cybox']}, 2: {delete: "*

 * *                 "['cybox']}}, 'event_c [â€¦]*

```diff
@@ -820,20 +820,18 @@
                                     "object": "event"
                                 },
                                 {
                                     "key": "x-ibm-finding.time_observed",
                                     "object": "finding"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "Title": [
                                 {
                                     "key": "x-ibm-finding.name",
@@ -851,15 +849,14 @@
                                 {
                                     "key": "x-ibm-finding.finding_type",
                                     "object": "finding",
                                     "transformer": "Alert"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -1434,26 +1431,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -1887,26 +1881,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -2286,26 +2277,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -2772,26 +2760,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -3276,26 +3261,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -3635,26 +3617,23 @@
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
-                                    "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
-                                "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
                             },
                             "event_link": [
                                 {
                                     "key": "external-reference.url",
                                     "object": "device_external_ref"
@@ -3749,18 +3728,14 @@
             "min": 1,
             "type": "number"
         },
         "selfSignedCert": {
             "optional": true,
             "type": "password"
         },
-        "sni": {
-            "optional": true,
-            "type": "text"
-        },
         "type": {
             "displayName": "Microsoft Defender for Endpoint",
             "group": "azure",
             "type": "connectorType"
         }
     }
 }
```

## stix_shifter_modules/msatp/configuration/lang_en.json

### Pretty-printed

 * *Similarity: 0.9642857142857143%*

 * *Differences: {"'connection'": "{delete: ['sni']}"}*

```diff
@@ -80,16 +80,12 @@
             "description": "Set the port number that is associated with the hostname or IP address",
             "label": "Host port"
         },
         "selfSignedCert": {
             "description": "Use self-signed Security Sockets Layer (SSL) certificate only if Microsoft Defender for Endpoint is configured with a self-signed SSL certificate",
             "label": "Microsoft Defender for Endpoint certificate"
         },
-        "sni": {
-            "description": "The Server Name Indicator (SNI) enables a separate hostname to be provided for SSL authentication",
-            "label": "Server Name Indicator"
-        },
         "type": {
             "description": "Data source type"
         }
     }
 }
```

## stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py

```diff
@@ -62,15 +62,14 @@
         self.identity_id = data_source["id"]
         self.ds_to_stix_map = ds_to_stix_map
         self.transformers = transformers
         self.options = options
         self.callback = callback
 
         # parse through options
-        self.cybox_default = options.get('cybox_default', True)
 
         self.properties = observable.properties
 
         self.data_source = data_source['name']
         self.ds_key_map = [val for val in self.gen_dict_extract('ds_key', ds_to_stix_map)]
 
         self.bundle = {
@@ -297,27 +296,33 @@
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
-                cybox = prop.get('cybox', self.cybox_default)
+                if "." in key:
+                    cybox = True
+                else:
+                    cybox = False
+                
+                # cybox = prop.get('cybox', self.cybox_default)
 
                 if self.callback:
                     try:
                         generic_hash_key = self.callback(parent_data, ds_sub_key, key, self.options)
                         if generic_hash_key:
                             key = generic_hash_key
                     except Exception as e:
                         continue
 
                 config_keys = key.split('.')
                 if len(config_keys) < 2:
-                    if False is prop.get('cybox', self.cybox_default): 
+                    # if False is prop.get('cybox', self.cybox_default):
+                    if not cybox:
                         object_tag_ref_map['out_cybox'][key] = self._compose_value_object(data, [], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                     pass
                 else:
                     type_name = config_keys[0]
                     property_key = config_keys[1]
                     # set the object to combine properties from same SCO
                     parent_key = prop['object'] if 'object' in prop else type_name
```

## stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.9965189098229874%*

 * *Differences: {"'DeviceAlertEvents'": "{'Timestamp': {2: {delete: ['cybox']}, 3: {delete: ['cybox']}}, "*

 * *                        "'event_count': {delete: ['cybox']}}",*

 * * "'DeviceEvents'": "{'Timestamp': {1: {delete: ['cybox']}, 2: {delete: ['cybox']}}, 'event_count': "*

 * *                   "{delete: ['cybox']}}",*

 * * "'DeviceFileEvents'": "{'Timestamp': {1: {delete: ['cybox']}, 2: {delete: ['cybox']}}, "*

 * *                       "'event_count': {delete: ['cybox']}}",*

 * * "'DeviceImageLoadEvents'": "{'Timestamp': {1: {delete: ['cybo [â€¦]*

```diff
@@ -187,20 +187,18 @@
                 "object": "event"
             },
             {
                 "key": "x-ibm-finding.time_observed",
                 "object": "finding"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "Title": [
             {
                 "key": "x-ibm-finding.name",
@@ -218,15 +216,14 @@
             {
                 "key": "x-ibm-finding.finding_type",
                 "object": "finding",
                 "transformer": "Alert"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -801,26 +798,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -1254,26 +1248,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -1653,26 +1644,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -2139,26 +2127,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -2643,26 +2628,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -3002,26 +2984,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
```

## stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.9965189098229874%*

 * *Differences: {"'DeviceAlertEvents'": "{'Timestamp': {2: {delete: ['cybox']}, 3: {delete: ['cybox']}}, "*

 * *                        "'event_count': {delete: ['cybox']}}",*

 * * "'DeviceEvents'": "{'Timestamp': {1: {delete: ['cybox']}, 2: {delete: ['cybox']}}, 'event_count': "*

 * *                   "{delete: ['cybox']}}",*

 * * "'DeviceFileEvents'": "{'Timestamp': {1: {delete: ['cybox']}, 2: {delete: ['cybox']}}, "*

 * *                       "'event_count': {delete: ['cybox']}}",*

 * * "'DeviceImageLoadEvents'": "{'Timestamp': {1: {delete: ['cybo [â€¦]*

```diff
@@ -187,20 +187,18 @@
                 "object": "event"
             },
             {
                 "key": "x-ibm-finding.time_observed",
                 "object": "finding"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "Title": [
             {
                 "key": "x-ibm-finding.name",
@@ -218,15 +216,14 @@
             {
                 "key": "x-ibm-finding.finding_type",
                 "object": "finding",
                 "transformer": "Alert"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -786,26 +783,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -1229,26 +1223,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -1618,26 +1609,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -2094,26 +2082,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -2583,26 +2568,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
@@ -2932,26 +2914,23 @@
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
-                "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
-                "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
-            "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
         },
         "event_link": [
             {
                 "key": "external-reference.url",
                 "object": "device_external_ref"
```

## stix_shifter_modules/msatp/stix_transmission/api_client.py

```diff
@@ -33,16 +33,15 @@
             headers['Authorization'] = "Bearer " + self.access_token.token
 
         self.client = RestApiClientAsync(self.host,
                                          self.connection.get('port', None),
                                          headers,
                                          url_modifier_function=url_modifier_function,
                                          cert_verify=self.connection.get(
-                                             'selfSignedCert', True),
-                                         sni=self.connection.get('sni', None)
+                                             'selfSignedCert', True)
                                          )
         return self.client
 
     async def ping_box(self):
         """Ping the endpoint."""
         endpoint = '/api'
         await self.init_async_client()
```

## stix_shifter_modules/msatp/stix_transmission/error_mapper.py

```diff
@@ -18,15 +18,15 @@
 
 class ErrorMapper:
     """"ErrorMapper class"""
     logger = logger.set_logger(__name__)
     DEFAULT_ERROR = ErrorCode.TRANSMISSION_MODULE_DEFAULT_ERROR
 
     @staticmethod
-    def set_error_code(json_data, return_obj):
+    def set_error_code(json_data, return_obj, connector=None):
         """ms_atp transmit specified error
          :param json_data: dict, error response of api_call
          :param return_obj: dict, returns error and error code"""
         error_type = ''
         
         if isinstance(json_data, tuple):
             error_type = 'HTTPSConnectionError'
@@ -40,8 +40,8 @@
 
         if error_type in ERROR_MAPPING:
             error_code = ERROR_MAPPING[error_type]
 
         if error_code == ErrorMapper.DEFAULT_ERROR:
             ErrorMapper.logger.error("failed to map: " + str(json_data))
 
-        ErrorMapperBase.set_error_code(return_obj, error_code)
+        ErrorMapperBase.set_error_code(return_obj, error_code, connector=connector)
```

## Comparing `stix_shifter_modules_msatp-5.3.0.dev827.dist-info/LICENSE.md` & `stix_shifter_modules_msatp-5.3.1.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_msatp-5.3.0.dev827.dist-info/METADATA` & `stix_shifter_modules_msatp-5.3.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: stix-shifter-modules-msatp
-Version: 5.3.0.dev827
+Version: 5.3.1
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `stix_shifter_modules_msatp-5.3.0.dev827.dist-info/NOTICE` & `stix_shifter_modules_msatp-5.3.1.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_msatp-5.3.0.dev827.dist-info/RECORD` & `stix_shifter_modules_msatp-5.3.1.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,27 +1,27 @@
 stix_shifter_modules/msatp/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/msatp/entry_point.py,sha256=zhlhvXf6Qn3A3wcYJX-n0c0rLGkchn_8oMEldexcRwE,425
-stix_shifter_modules/msatp/configuration/config.json,sha256=7KLkLQ50TTw9ANtvR4qxs9d3q-1wnQnxYseZMxWtoEs,191814
+stix_shifter_modules/msatp/configuration/config.json,sha256=-14Ea5z-ZijQuJvK8YkFkXYwEDh5VJ5oy8AD6eD78JE,190665
 stix_shifter_modules/msatp/configuration/dialects.json,sha256=tewYuoIE-WBBxsLTlOstMkMSUs6sFlEyW1dveC61xwk,78
-stix_shifter_modules/msatp/configuration/lang_en.json,sha256=AJ-nfgt5IlkuZFCvdLfPa6ifzYYObOGBi98QbBmSKSc,5039
+stix_shifter_modules/msatp/configuration/lang_en.json,sha256=k9AsZrIPyzF1Y9kf-JeWizI7kodr5MRSKkQVw1uN3zs,4838
 stix_shifter_modules/msatp/stix_translation/__init__.py,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py,sha256=8KbNAbPFHVIw6CN4tylW35GqJ1sxBZpaxpQaFAM6e0M,22536
+stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
 stix_shifter_modules/msatp/stix_translation/query_constructor.py,sha256=Sds-DOc0j3PDktT45NYgqwPL2GYag_XUMCn85FUjs5Y,18741
 stix_shifter_modules/msatp/stix_translation/query_translator.py,sha256=tPOKCH8_ueGfhbGaEjJZcMIEl4B8787nw5R23flMoMU,1038
 stix_shifter_modules/msatp/stix_translation/results_translator.py,sha256=cMXZZZuMShDHbl1V0kSnd0zF_yU4YChPIPDh9blMj44,8390
 stix_shifter_modules/msatp/stix_translation/transformers.py,sha256=yJhqm4qyC2HZz-FQWrYroPx0Ytb4BFXEXk7xICra9mQ,5510
 stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json,sha256=nFjEbCUl4oiEbkcy8UeOLgIeOs78ryjY4wYnEJbhHUE,20749
 stix_shifter_modules/msatp/stix_translation/json/operators.json,sha256=rfECBPtyeCEWZGrj_h0q6ksWJZwZZrT-BkD1f0OspiQ,583
-stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json,sha256=Mj-ZpckZIZ9vpZrOv11YCpxkokWEAncJ9QiLt6ZcP_A,69903
+stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json,sha256=6gnc3Qm6escwAtpFnNwq60THZS31K1YvhsauaBoUu9w,69413
 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json,sha256=_VlTGRLC5xq7t1Xqs4JO9qvNm0k7Iu4wD2ZpxrG0mKI,20764
-stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json,sha256=ClM2cE90pF3ku82lmPckryKX1ZeFcgd5-6R8ysenDRM,68275
+stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json,sha256=maYUfS9A5qdc8vIObVRXlk24en0XDrYvPMa9wk7xP-U,67785
 stix_shifter_modules/msatp/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/msatp/stix_transmission/api_client.py,sha256=qkndj5xxAu3-RtXTsf6NAnNIMmzDfxfIuGp1v-c-uOw,2952
+stix_shifter_modules/msatp/stix_transmission/api_client.py,sha256=5e-23bJm1MWxpdk62BsTOPi7PUj67WLTEQB4yyPDqxo,2873
 stix_shifter_modules/msatp/stix_transmission/connector.py,sha256=9Ud5sONBlRHd4v2Ex8GZWJ5TRYKI2qRITOmanheCPZg,3779
 stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py,sha256=U81Dm90jO1ElomLhNrw8FHPWaPEHL3SrppWv05bhe9U,11998
-stix_shifter_modules/msatp/stix_transmission/error_mapper.py,sha256=DjdDVRyTJNgAGlbWIUo6zxBxTCLwJeQqE4Ejy1krqYU,1850
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/METADATA,sha256=dTu7uDnnZnuIpCtdgv723yTNtguxtioeMzExcEkh5DE,8042
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_msatp-5.3.0.dev827.dist-info/RECORD,,
+stix_shifter_modules/msatp/stix_transmission/error_mapper.py,sha256=3qEYAwwrcLu-6FCscZdNKIWNgYJR3JQH9aLNZ5z84uE,1887
+stix_shifter_modules_msatp-5.3.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_msatp-5.3.1.dist-info/METADATA,sha256=2g6_BxxPdN7T3jdSweP_nYUM-KzRZtHnM8dTxvmZ7Hw,8035
+stix_shifter_modules_msatp-5.3.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_msatp-5.3.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_modules_msatp-5.3.1.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_msatp-5.3.1.dist-info/RECORD,,
```

